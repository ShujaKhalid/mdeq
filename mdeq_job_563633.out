/var/spool/slurmd/job563633/slurm_script: line 15: pytorch1.4-cuda10.1-python3.6: command not found
Namespace(cfg='experiments/cifar/cls_mdeq_TINY.yaml', dataDir='', lbd=0.0, logDir='', modelDir='', opts=[], percent=1.0, testModel='')
{'AUTO_RESUME': False,
 'CUDNN': CfgNode({'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True}),
 'DATASET': {'COLOR_RGB': False,
             'DATASET': 'cifar10',
             'DATA_FORMAT': 'jpg',
             'EXTRA_TRAIN_SET': '',
             'FLIP': True,
             'HYBRID_JOINTS_TYPE': '',
             'NUM_CLASSES': 1000,
             'NUM_JOINTS_HALF_BODY': 8,
             'PROB_HALF_BODY': 0.0,
             'ROOT': 'data/cifar10/',
             'ROT_FACTOR': 30,
             'SCALE_FACTOR': 0.25,
             'SELECT_DATA': False,
             'TEST_SET': 'val',
             'TRAIN_SET': 'train'},
 'DATA_DIR': '',
 'DEBUG': {'DEBUG': False,
           'SAVE_BATCH_IMAGES_GT': False,
           'SAVE_BATCH_IMAGES_PRED': False,
           'SAVE_HEATMAPS_GT': False,
           'SAVE_HEATMAPS_PRED': False},
 'GPUS': (0,),
 'LOG_DIR': 'log/',
 'LOSS': {'CLASS_BALANCE': True,
          'OHEMKEEP': 100000,
          'OHEMTHRES': 0.9,
          'TOPK': 8,
          'USE_DIFFERENT_JOINTS_WEIGHT': False,
          'USE_OHEM': False,
          'USE_TARGET_WEIGHT': True},
 'MODEL': {'B_THRES': 30,
           'DOWNSAMPLE_TIMES': 0,
           'DROPOUT': 0.15,
           'EXPANSION_FACTOR': 5,
           'EXTRA': {'FULL_STAGE': {'BLOCK': 'BASIC',
                                    'FINAL_CHANSIZE': 128,
                                    'FUSE_METHOD': 'SUM',
                                    'HEAD_CHANNELS': [4, 8, 16],
                                    'NUM_BLOCKS': [1, 1, 1],
                                    'NUM_BRANCHES': 3,
                                    'NUM_CHANNELS': [8, 16, 32],
                                    'NUM_MODULES': 1}},
           'F_THRES': 30,
           'HEATMAP_SIZE': [64, 64],
           'IMAGE_SIZE': [32, 32],
           'INIT_WEIGHTS': True,
           'NAME': 'mdeq',
           'NUM_CLASSES': 10,
           'NUM_GROUPS': 8,
           'NUM_JOINTS': 17,
           'NUM_LAYERS': 10,
           'PRETRAINED': '',
           'SIGMA': 2,
           'TAG_PER_JOINT': True,
           'TARGET_TYPE': 'gaussian',
           'WNORM': True},
 'OUTPUT_DIR': 'output/',
 'PERCENT': 1.0,
 'PIN_MEMORY': True,
 'PRINT_FREQ': 100,
 'RANK': 0,
 'TEST': {'BASE_SIZE': 2048,
          'BATCH_SIZE_PER_GPU': 64,
          'BBOX_THRE': 1.0,
          'CENTER_CROP_TEST': False,
          'COCO_BBOX_FILE': '',
          'FLIP_TEST': False,
          'IMAGE_SIZE': [2048, 1024],
          'IMAGE_THRE': 0.1,
          'IN_VIS_THRE': 0.0,
          'MODEL_FILE': '',
          'MULTI_SCALE': False,
          'NMS_THRE': 0.6,
          'NUM_SAMPLES': 0,
          'OKS_THRE': 0.5,
          'POST_PROCESS': False,
          'SCALE_LIST': [1],
          'SHIFT_HEATMAP': False,
          'SOFT_NMS': False,
          'USE_GT_BBOX': False},
 'TRAIN': {'BASE_SIZE': 2048,
           'BATCH_SIZE_PER_GPU': 64,
           'BEGIN_EPOCH': 0,
           'CHECKPOINT': '',
           'CLIP': -1.0,
           'DOWNSAMPLERATE': 1,
           'END_EPOCH': 50,
           'EXTRA_EPOCH': 0,
           'EXTRA_LR': 0.001,
           'FLIP': True,
           'GAMMA1': 0.99,
           'GAMMA2': 0.0,
           'IGNORE_LABEL': -1,
           'IMAGE_SIZE': [1024, 512],
           'LR': 0.001,
           'LR_FACTOR': 0.1,
           'LR_SCHEDULER': 'cosine',
           'LR_STEP': [30, 60, 90],
           'MODEL_FILE': '',
           'MOMENTUM': 0.9,
           'MULTI_SCALE': True,
           'NESTEROV': True,
           'OPTIMIZER': 'adam',
           'PRETRAIN_STEPS': 0,
           'RESUME': False,
           'SCALE_FACTOR': 16,
           'SHUFFLE': True,
           'WD': 0.0},
 'WORKERS': 2}
=> init weights from normal distribution

[36mSetting default tensor type to cuda.FloatTensor[0m
=> creating output/cifar10/cls_mdeq_TINY
=> creating log/cifar10/mdeq/cls_mdeq_TINY_2020-07-18-16-47
Running from mdeq_core...
--Training--
x_list.shape: 3
Finished constructing model!
Files already downloaded and verified
Files already downloaded and verified
Traceback (most recent call last):
  File "./tools/cls_train.py", line 264, in <module>
    main()
  File "./tools/cls_train.py", line 229, in main
    final_output_dir, tb_log_dir, writer_dict, topk=topk)
  File "/h/skhalid/mdeq/tools/../lib/core/cls_function.py", line 43, in train
    output, df_dx = model(input, train_step=(lr_scheduler._step_count-1), writer=writer_dict['writer'])
AttributeError: 'CosineAnnealingLR' object has no attribute '_step_count'
Namespace(cfg='experiments/cifar/cls_mdeq_TINY.yaml', dataDir='', lbd=0.2, logDir='', modelDir='', opts=[], percent=1.0, testModel='')
{'AUTO_RESUME': False,
 'CUDNN': CfgNode({'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True}),
 'DATASET': {'COLOR_RGB': False,
             'DATASET': 'cifar10',
             'DATA_FORMAT': 'jpg',
             'EXTRA_TRAIN_SET': '',
             'FLIP': True,
             'HYBRID_JOINTS_TYPE': '',
             'NUM_CLASSES': 1000,
             'NUM_JOINTS_HALF_BODY': 8,
             'PROB_HALF_BODY': 0.0,
             'ROOT': 'data/cifar10/',
             'ROT_FACTOR': 30,
             'SCALE_FACTOR': 0.25,
             'SELECT_DATA': False,
             'TEST_SET': 'val',
             'TRAIN_SET': 'train'},
 'DATA_DIR': '',
 'DEBUG': {'DEBUG': False,
           'SAVE_BATCH_IMAGES_GT': False,
           'SAVE_BATCH_IMAGES_PRED': False,
           'SAVE_HEATMAPS_GT': False,
           'SAVE_HEATMAPS_PRED': False},
 'GPUS': (0,),
 'LOG_DIR': 'log/',
 'LOSS': {'CLASS_BALANCE': True,
          'OHEMKEEP': 100000,
          'OHEMTHRES': 0.9,
          'TOPK': 8,
          'USE_DIFFERENT_JOINTS_WEIGHT': False,
          'USE_OHEM': False,
          'USE_TARGET_WEIGHT': True},
 'MODEL': {'B_THRES': 30,
           'DOWNSAMPLE_TIMES': 0,
           'DROPOUT': 0.15,
           'EXPANSION_FACTOR': 5,
           'EXTRA': {'FULL_STAGE': {'BLOCK': 'BASIC',
                                    'FINAL_CHANSIZE': 128,
                                    'FUSE_METHOD': 'SUM',
                                    'HEAD_CHANNELS': [4, 8, 16],
                                    'NUM_BLOCKS': [1, 1, 1],
                                    'NUM_BRANCHES': 3,
                                    'NUM_CHANNELS': [8, 16, 32],
                                    'NUM_MODULES': 1}},
           'F_THRES': 30,
           'HEATMAP_SIZE': [64, 64],
           'IMAGE_SIZE': [32, 32],
           'INIT_WEIGHTS': True,
           'NAME': 'mdeq',
           'NUM_CLASSES': 10,
           'NUM_GROUPS': 8,
           'NUM_JOINTS': 17,
           'NUM_LAYERS': 10,
           'PRETRAINED': '',
           'SIGMA': 2,
           'TAG_PER_JOINT': True,
           'TARGET_TYPE': 'gaussian',
           'WNORM': True},
 'OUTPUT_DIR': 'output/',
 'PERCENT': 1.0,
 'PIN_MEMORY': True,
 'PRINT_FREQ': 100,
 'RANK': 0,
 'TEST': {'BASE_SIZE': 2048,
          'BATCH_SIZE_PER_GPU': 64,
          'BBOX_THRE': 1.0,
          'CENTER_CROP_TEST': False,
          'COCO_BBOX_FILE': '',
          'FLIP_TEST': False,
          'IMAGE_SIZE': [2048, 1024],
          'IMAGE_THRE': 0.1,
          'IN_VIS_THRE': 0.0,
          'MODEL_FILE': '',
          'MULTI_SCALE': False,
          'NMS_THRE': 0.6,
          'NUM_SAMPLES': 0,
          'OKS_THRE': 0.5,
          'POST_PROCESS': False,
          'SCALE_LIST': [1],
          'SHIFT_HEATMAP': False,
          'SOFT_NMS': False,
          'USE_GT_BBOX': False},
 'TRAIN': {'BASE_SIZE': 2048,
           'BATCH_SIZE_PER_GPU': 64,
           'BEGIN_EPOCH': 0,
           'CHECKPOINT': '',
           'CLIP': -1.0,
           'DOWNSAMPLERATE': 1,
           'END_EPOCH': 50,
           'EXTRA_EPOCH': 0,
           'EXTRA_LR': 0.001,
           'FLIP': True,
           'GAMMA1': 0.99,
           'GAMMA2': 0.0,
           'IGNORE_LABEL': -1,
           'IMAGE_SIZE': [1024, 512],
           'LR': 0.001,
           'LR_FACTOR': 0.1,
           'LR_SCHEDULER': 'cosine',
           'LR_STEP': [30, 60, 90],
           'MODEL_FILE': '',
           'MOMENTUM': 0.9,
           'MULTI_SCALE': True,
           'NESTEROV': True,
           'OPTIMIZER': 'adam',
           'PRETRAIN_STEPS': 0,
           'RESUME': False,
           'SCALE_FACTOR': 16,
           'SHUFFLE': True,
           'WD': 0.0},
 'WORKERS': 2}
=> init weights from normal distribution

[36mSetting default tensor type to cuda.FloatTensor[0m
=> creating output/cifar10/cls_mdeq_TINY
=> creating log/cifar10/mdeq/cls_mdeq_TINY_2020-07-18-16-47
Running from mdeq_core...
--Training--
x_list.shape: 3
Finished constructing model!
Files already downloaded and verified
Files already downloaded and verified
Traceback (most recent call last):
  File "./tools/cls_train.py", line 264, in <module>
    main()
  File "./tools/cls_train.py", line 229, in main
    final_output_dir, tb_log_dir, writer_dict, topk=topk)
  File "/h/skhalid/mdeq/tools/../lib/core/cls_function.py", line 43, in train
    output, df_dx = model(input, train_step=(lr_scheduler._step_count-1), writer=writer_dict['writer'])
AttributeError: 'CosineAnnealingLR' object has no attribute '_step_count'
Namespace(cfg='experiments/cifar/cls_mdeq_TINY.yaml', dataDir='', lbd=0.4, logDir='', modelDir='', opts=[], percent=1.0, testModel='')
{'AUTO_RESUME': False,
 'CUDNN': CfgNode({'BENCHMARK': True, 'DETERMINISTIC': False, 'ENABLED': True}),
 'DATASET': {'COLOR_RGB': False,
             'DATASET': 'cifar10',
             'DATA_FORMAT': 'jpg',
             'EXTRA_TRAIN_SET': '',
             'FLIP': True,
             'HYBRID_JOINTS_TYPE': '',
             'NUM_CLASSES': 1000,
             'NUM_JOINTS_HALF_BODY': 8,
             'PROB_HALF_BODY': 0.0,
             'ROOT': 'data/cifar10/',
             'ROT_FACTOR': 30,
             'SCALE_FACTOR': 0.25,
             'SELECT_DATA': False,
             'TEST_SET': 'val',
             'TRAIN_SET': 'train'},
 'DATA_DIR': '',
 'DEBUG': {'DEBUG': False,
           'SAVE_BATCH_IMAGES_GT': False,
           'SAVE_BATCH_IMAGES_PRED': False,
           'SAVE_HEATMAPS_GT': False,
           'SAVE_HEATMAPS_PRED': False},
 'GPUS': (0,),
 'LOG_DIR': 'log/',
 'LOSS': {'CLASS_BALANCE': True,
          'OHEMKEEP': 100000,
          'OHEMTHRES': 0.9,
          'TOPK': 8,
          'USE_DIFFERENT_JOINTS_WEIGHT': False,
          'USE_OHEM': False,
          'USE_TARGET_WEIGHT': True},
 'MODEL': {'B_THRES': 30,
           'DOWNSAMPLE_TIMES': 0,
           'DROPOUT': 0.15,
           'EXPANSION_FACTOR': 5,
           'EXTRA': {'FULL_STAGE': {'BLOCK': 'BASIC',
                                    'FINAL_CHANSIZE': 128,
                                    'FUSE_METHOD': 'SUM',
                                    'HEAD_CHANNELS': [4, 8, 16],
                                    'NUM_BLOCKS': [1, 1, 1],
                                    'NUM_BRANCHES': 3,
                                    'NUM_CHANNELS': [8, 16, 32],
                                    'NUM_MODULES': 1}},
           'F_THRES': 30,
           'HEATMAP_SIZE': [64, 64],
           'IMAGE_SIZE': [32, 32],
           'INIT_WEIGHTS': True,
           'NAME': 'mdeq',
           'NUM_CLASSES': 10,
           'NUM_GROUPS': 8,
           'NUM_JOINTS': 17,
           'NUM_LAYERS': 10,
           'PRETRAINED': '',
           'SIGMA': 2,
           'TAG_PER_JOINT': True,
           'TARGET_TYPE': 'gaussian',
           'WNORM': True},
 'OUTPUT_DIR': 'output/',
 'PERCENT': 1.0,
 'PIN_MEMORY': True,
 'PRINT_FREQ': 100,
 'RANK': 0,
 'TEST': {'BASE_SIZE': 2048,
          'BATCH_SIZE_PER_GPU': 64,
          'BBOX_THRE': 1.0,
          'CENTER_CROP_TEST': False,
          'COCO_BBOX_FILE': '',
          'FLIP_TEST': False,
          'IMAGE_SIZE': [2048, 1024],
          'IMAGE_THRE': 0.1,
          'IN_VIS_THRE': 0.0,
          'MODEL_FILE': '',
          'MULTI_SCALE': False,
          'NMS_THRE': 0.6,
          'NUM_SAMPLES': 0,
          'OKS_THRE': 0.5,
          'POST_PROCESS': False,
          'SCALE_LIST': [1],
          'SHIFT_HEATMAP': False,
          'SOFT_NMS': False,
          'USE_GT_BBOX': False},
 'TRAIN': {'BASE_SIZE': 2048,
           'BATCH_SIZE_PER_GPU': 64,
           'BEGIN_EPOCH': 0,
           'CHECKPOINT': '',
           'CLIP': -1.0,
           'DOWNSAMPLERATE': 1,
           'END_EPOCH': 50,
           'EXTRA_EPOCH': 0,
           'EXTRA_LR': 0.001,
           'FLIP': True,
           'GAMMA1': 0.99,
           'GAMMA2': 0.0,
           'IGNORE_LABEL': -1,
           'IMAGE_SIZE': [1024, 512],
           'LR': 0.001,
           'LR_FACTOR': 0.1,
           'LR_SCHEDULER': 'cosine',
           'LR_STEP': [30, 60, 90],
           'MODEL_FILE': '',
           'MOMENTUM': 0.9,
           'MULTI_SCALE': True,
           'NESTEROV': True,
           'OPTIMIZER': 'adam',
           'PRETRAIN_STEPS': 0,
           'RESUME': False,
           'SCALE_FACTOR': 16,
           'SHUFFLE': True,
           'WD': 0.0},
 'WORKERS': 2}
